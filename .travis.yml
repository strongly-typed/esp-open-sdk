os:
#    - linux # Exclude for development to safe Travis minutes
    - osx

matrix:
    include:
        - name: "macOS 13"
          os: osx
          osx_image: xcode10.1

before_script:
- (cd /usr/local/bin/; ln -s ../Cellar/binutils/2.31.1_2/bin/greadelf greadelf)
- (cd /usr/local/bin/; ln -s ../Cellar/binutils/2.31.1_2/bin/gobjcopy gobjcopy)
- hdiutil create -size 3g -volname "esp8266-ws" -fs "Case-sensitive HFS+" ~/esp8266_ws.dmg
- mkdir ~/esp8266-ws
- hdiutil attach -mountpoint ~/esp8266-ws ~/esp8266_ws.dmg
- mount

dist: xenial
language: c
sudo: false

addons:
  apt:
    packages:
    - make
    - unrar
    - autoconf
    - automake
    - libtool
    - libtool-bin
    - gcc
    - g++
    - gperf
    - flex
    - bison
    - texinfo
    - gawk
    - libncurses5-dev
    - libexpat1-dev
    - python
    - python-serial
    - sed
    - git
    - help2man
  homebrew:
    brewfile: true
    update: true

script:
  # Travis sets this due to "language: c", but it confuses autotools configure when cross-building
  - unset CC
  - make
